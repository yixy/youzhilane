# OS笔记(1)——现代操作系统概述 #

## 1. 什么是操作系统 ##

**计算机系统可分为硬件系统和软件系统。操作系统是运行在硬件系统上的一层计算机软件，它为用户提供一个简单清晰的计算机模型，并负责管理计算机硬件设备。**

**操作系统位于裸机之上，为所有其它软件提供基础的运行环境。**

```
--------------------------------------
应用程序（WEB浏览器、游戏、音/视频播放器等）
--------------------------------------
       应用程序接口（CLI、GUI）
--------------------------------------
           操作系统（内核）
--------------------------------------
                硬件
--------------------------------------
```

**多数计算机有两种运行模式，计算机软件分别运行在这两种模式下，通常OS运行在内核态、其它软件运行在用户态。**

* 内核态：具有对硬件的完全访问权，可以执行机器能够运行的任何指令。
* 用户态：只能执行机器指令中的一个子集。

应用程序接口（shell及公共库函数，如CLI或GUI）通过系统调用和内核进行交互完成一些内核权限的操作。通常，应用程序通过应用程序接口完成相应的内核权限的操作，应用程序也可以直接使用系统调用完成相关操作。

![操作系统所处的位置](/youzhilane/img/操作系统-内核.jpg)

> Linux 按照特权等级，把进程的运行空间分为内核空间和用户空间，分别对应着下图中， CPU 特权等级的 Ring 0 和 Ring 3。内核空间（Ring 0）具有最高权限，可以直接访问所有资源；用户空间（Ring 3）只能访问受限资源，不能直接访问内存等硬件设备，必须通过系统调用陷入到内核中，才能访问这些特权资源。

***注意1：这里所说的操作系统是狭义的，即指操作系统内核。在很多语境下，广义上的操作系统概念可能还会涵盖了一些其它不属于内核的部分。***

***注意2：许多系统中，存在一些用户态下运行的程序协助内核完成特权功能。这些在内核外运行的程序也被有争议地被认为是操作系统的一部分，或者至少与操作系统密切相关。***

## 2. 操作系统的作用 ##

其实前面已经提到了操作系统的作用，这里再总结一下：

* 为用户（应用程序员，实际上是应用程序）提供一个资源集的清晰抽象。
* 管理计算机硬件资源。

操作系统中的进程/线程、虚拟地址空间、文件，分别可以看作是对CPU、内存、IO的抽象。

## 3. 操作系统历史 ##

一个粗略的操作系统发展历史描述如下：

* 无操作系统：真空管计算机与手工操作（1945-1955），人们使用插拔电缆和使用穿孔卡片的方式控制机器的基本功能。
* 单道批处理系统：晶体管计算机与脱机IO、批处理技术（1955-1965），人们使用外围设备将输入读入磁带，操作员在主机上装入一个特殊的程序（现代OS前身），它从磁带上读取一个作业并运行。当一个作业完全结束后，操作员取下输入磁带和输出磁带，继续换取下一批作业进行处理。完成作业的输出磁带被拿到外围设备上进行脱机打印。
* 多道批处理系统：集成电路芯片和多道程序设计（1965-）。同时把几个作业放入内存，并允许他们交替执行，以减少昂贵的CPU空闲时间浪费。
* 现代操作系统：超大规模集成电路和现代操作系统。批处理、分时、实时、分布式等各类操作系统并存发展。

## 4. 现代操作系统的主要功能 ##

* 处理机管理功能：使用进程抽象模型，实现进程控制、通信、调度等机制。
* 内存管理功能：使用地址空间抽象模型，实现内存管理与保护。
* 文件管理功能：现代计算机系统中，程序和数据总是存储在磁盘上以供使用，操作系统使用文件抽象模型对磁盘进行管理。
* 设备管理功能：提供外围IO设备的抽象和管理功能。
* 提供系统调用：提供一组系统调用，这些接口是为用户程序访问系统资源而设置的。例如，CLI（Command Line Interface）和GUI（Graph User Interface）是在系统调用接口之上构建的，不过他们通常不运行在内核态。

## 5. 操作系统结构 ##

* 单体系统（单内核）：整个OS以国产集合的方式编写，链接成一个大型可执行二进制程序。
* 微内核：将OS划分成小的、良好定义的模块。只有其中一个模块——微内核，运行在内核态；其余模块，由于功能相对弱些，则作为普通用户进程运行。这样提高了内核的稳定性。

## 6. 延伸阅读 ##

多媒体操作系统，可参考《现代操作系统》(Tanenbaum)。

《性能之巅》第三章 操作系统
