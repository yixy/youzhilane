# 堆与堆排序 #

## 1. 堆的定义 ##

堆实质上是满足如下性质的完全二叉树：完全二叉树中任一非叶子结点均小于（大于）它的孩子结点。

若n个元素序列{a1,a2,...,an}满足：

```
ai<=a2i && ai<=a2i+1，小根堆
ai>=a2i && ai>=a2i+1，大根堆
```

![大根堆与小根堆](http://sweeat.me/大根堆与小根堆.png)

> 完全二叉树的性质：
> 
> 1. 具有n个结点的完全二叉树深度为|logn|+1。（log底为2）
> 
> 2. 含n个结点的完全二叉树，其序号为i的结点：1）若i=1，则根是i；若i>1，则父亲结点是`m[i/2]`。（`m[]`向下取整，`M[]`向上取整）；2）若2i>n，则结点i无左孩子（i为叶子结点），否则其左孩子为2i；3）若2i+1>n，则结点i无右孩子，否则其右孩子结点是2i+1。

## 2. 堆的筛选调整 ##

筛选：如何在输出堆顶元素后，调整剩余元素形成新的堆

* 输出堆顶元素后，以堆中最后一个元素替代之；
* 然后将根结点值与左右子树堆根结点值进行比较，并与其中较小（大）者交换。
* 重复上述过程，直到叶子结点，将得到一个新的堆。

## 3. 堆的构造 ##

因为有如下性质，所以我们只需要依次将序号为n/2，n/2-1，...，1的结点为根的子树均调整为堆即可将无序序列构建成一个堆。即：对应n个元素组成的无序序列，“筛选”只需要从n/2个元素开始。

* 单结点的二叉树是堆；
* 在完全二叉树中所有叶子结点（序号i>n/2）是堆（堆中只有一个元素）

构造方法：从最后一个非叶子结点开始，以此向前调整该结点为根的堆（与叶子结点比较调整，与筛选中的比较算法相同）。

## 4. 堆排序 ##

初始堆化所需时间不超过O(n)

排序阶段（不包含初始堆化）：一次重新堆化所需时间不超过O(logn)；n-1次循环所需时间不超过O(n*logn)

* 内部排序、串行排序、比较排序、原地排序、不稳定排序、自然排序
* 时间复杂度：最坏O(nlogn)，平均O(nlogn)，最好O(nlogn)
* 空间复杂度：O(n^2)